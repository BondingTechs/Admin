import{d as e,a}from"./@vue.runtime-dom-90e9fdb1.js";import{u as s}from"./index-8ab01e20.js";import"./vue-echarts-f79e68f9.js";import{a as o}from"./element-plus-ad41b746.js";import"./store-96e17a43.js";import{u as r}from"./index-98f4437c.js";import{d as t,e as l,o as i,c as d,R as p,a as n,b as c,J as m,K as u,N as f,al as v,ak as h}from"./@vue.runtime-core-e50a2272.js";import{e as j,h as b,u as g}from"./@vue.reactivity-da630c06.js";import{_ as y}from"./_plugin-vue_export-helper-c4cb8a60.js";import{L as _}from"./@vue.shared-5670d8a7.js";import"./axios-966d6f38.js";import"./nprogress-6d1393d1.js";import"./lodash-es-a085e596.js";import"./vue-router-916993ce.js";import"./pinia-bb8d2f73.js";import"./vue-demi-5b9a0fa5.js";import"./@vueuse.core-2fa6d9e6.js";import"./@vueuse.shared-ca6b0f06.js";import"./vue-b5fce9d1.js";import"./mockjs-93ca2bc8.js";import"./mitt-dab1f1cb.js";import"./@element-plus.icons-vue-26cbeb7a.js";import"./@popperjs.core-040feab9.js";import"./@ctrl.tinycolor-84ad98d6.js";import"./dayjs-dd470533.js";import"./async-validator-efc2d198.js";import"./memoize-one-99e54574.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./@floating-ui.dom-9d85c32a.js";import"./@floating-ui.core-c56fb7e8.js";import"./resize-detector-94afada7.js";import"./echarts-6943293a.js";import"./tslib-ed971494.js";import"./zrender-0d232395.js";const w=["innerHTML"],x=["src"],k=t({name:"undefined"}),C=y(t({...k,emits:["update:modelValue","change"],setup(e,{expose:a,emit:s}){const{service:t}=r(),p=j(""),n=j("");function c(){t.base.open.captcha({height:40,width:150}).then((({captchaId:e,data:a})=>{a.includes(";base64,")?p.value=a:n.value=a,s("update:modelValue",e),s("change",{base64:p,svg:n,captchaId:e})})).catch((e=>{o.error(e.message)}))}return l((()=>{c()})),a({refresh:c}),(e,a)=>(i(),d("div",{class:"captcha",onClick:c},[n.value?(i(),d("div",{key:0,class:"svg",innerHTML:n.value},null,8,w)):(i(),d("img",{key:1,class:"base64",src:p.value,alt:""},null,8,x))]))}}),[["__scopeId","data-v-63c69ae6"]]),V={class:"page-login"},I={class:"box"},z={class:"logo"},T=(e=>(v("data-v-ae13c37a"),e=e(),h(),e))((()=>n("p",{class:"desc"},"一款快速開發後臺權限管理系統",-1))),U={class:"row"},K=["onKeyup"],L={class:"op"},H=t({name:"login"}),M=y(t({...H,setup(t){const{refs:l,setRefs:v,router:h,service:y}=r(),{user:w,app:x}=s(),k=j(!1),H=b({username:"",password:"",captchaId:"",verifyCode:""});async function M(){if(!H.username)return o.error("用戶名不能為空");if(!H.password)return o.error("密碼不能為空");if(!H.verifyCode)return o.error("圖片驗證碼不能為空");k.value=!0;try{await y.base.open.login(H).then((e=>{w.setToken(e)})),await Promise.all(x.events.hasToken.map((e=>e()))),h.push("/")}catch(e){l.value.captcha.refresh(),o.error(e.message)}k.value=!1}return(s,o)=>{const r=p("el-form-item"),t=p("el-button"),l=p("el-form");return i(),d("div",V,[n("div",I,[n("div",z,[n("span",null,_(g(x).info.name),1)]),T,c(l,{"label-position":"top",class:"form",disabled:k.value,size:"large"},{default:m((()=>[c(r,{label:"用戶名"},{default:m((()=>[u(n("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>H.username=e),placeholder:"請輸入用戶名",maxlength:"20",autocomplete:"on"},null,512),[[e,H.username]])])),_:1}),c(r,{label:"密碼"},{default:m((()=>[u(n("input",{"onUpdate:modelValue":o[1]||(o[1]=e=>H.password=e),type:"password",placeholder:"請輸入密碼",maxlength:"20",autocomplete:"off"},null,512),[[e,H.password]])])),_:1}),c(r,{label:"驗證碼"},{default:m((()=>[n("div",U,[u(n("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>H.verifyCode=e),placeholder:"圖片驗證碼",maxlength:"4",onKeyup:a(M,["enter"])},null,40,K),[[e,H.verifyCode]]),c(C,{ref:g(v)("captcha"),modelValue:H.captchaId,"onUpdate:modelValue":o[3]||(o[3]=e=>H.captchaId=e),onChange:o[4]||(o[4]=()=>{H.verifyCode=""})},null,8,["modelValue"])])])),_:1}),n("div",L,[c(t,{round:"",loading:k.value,onClick:M},{default:m((()=>[f("登錄")])),_:1},8,["loading"])])])),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-ae13c37a"]]);export{M as default};
